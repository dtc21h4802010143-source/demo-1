{% extends "base.html" %}
{% block title %}Kết quả xét tuyển{% endblock %}
{% block content %}
<section class="max-w-xl mx-auto mt-12 p-8 bg-white rounded-2xl shadow-lg">
  <h1 class="text-2xl font-bold mb-6 text-center text-indigo-700">Tra cứu kết quả tuyển sinh</h1>
  <form method="post" action="{{ url_for('view_results') }}" class="space-y-4 mb-8">
    <div>
      <label for="query" class="block font-semibold mb-2">Số CCCD, mã hồ sơ hoặc số điện thoại</label>
      <input type="text" id="query" name="query" value="{{ request.form.query if request.method == 'POST' }}" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Nhập số CCCD, mã hồ sơ hoặc số điện thoại">
      <p class="text-sm text-gray-500 mt-1">Chỉ cần nhập <b>một</b> trong các thông tin trên.</p>
    </div>
    <button type="submit" class="w-full py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white font-bold rounded-lg hover:scale-105 transition-all">Tra cứu kết quả</button>
  </form>
  {% if result %}
  <div class="mt-8 p-6 bg-indigo-50 rounded-xl">
    <h2 class="text-xl font-bold text-indigo-700 mb-2">Kết quả tuyển sinh</h2>
    <p><strong>Họ tên:</strong> {{ result.full_name }}</p>
    <p><strong>Ngành trúng tuyển:</strong> {{ result.program_name }}</p>
    <p><strong>Trạng thái:</strong> <span class="font-semibold text-green-600">{{ result.status }}</span></p>
    <p><strong>Ngày xét tuyển:</strong> {{ result.submitted_at }}</p>
  </div>
  {% elif error %}
  <div class="mt-8 p-4 bg-red-100 text-red-700 rounded-lg">{{ error }}</div>
  {% endif %}
</section>

<div class="flex min-h-[70vh] items-center justify-center py-8">
  <div class="w-full max-w-5xl bg-white rounded-2xl shadow-xl p-8">
    <div class="flex items-center gap-3 mb-6">
      <i class="fa-solid fa-trophy text-2xl text-yellow-400"></i>
      <h2 class="text-2xl font-bold">Kết quả xét tuyển của bạn</h2>
    </div>
    {% if wishes %}
    <div class="overflow-x-auto">
      <table class="min-w-full border rounded-lg text-sm">
        <thead class="bg-gray-100">
          <tr>
            <th class="py-2 px-4 text-left font-medium">STT</th>
            <th class="py-2 px-4 text-left font-medium">Ngành đăng ký</th>
            <th class="py-2 px-4 text-left font-medium">Ngày nộp</th>
            <th class="py-2 px-4 text-left font-medium">Trạng thái</th>
          </tr>
        </thead>
        <tbody>
          {% for wish in wishes %}
          <tr class="border-b">
            <td class="py-2 px-4">{{ loop.index }}</td>
            <td class="py-2 px-4">{{ wish.program.name }}</td>
            <td class="py-2 px-4">{{ wish.application_date.strftime('%d/%m/%Y') }}</td>
            <td class="py-2 px-4">
              {% if wish.status == 'Accepted' %}
                <span class="text-emerald-600 font-semibold"><i class="fa-solid fa-circle-check"></i> Đỗ</span>
              {% elif wish.status == 'Rejected' %}
                <span class="text-red-500 font-semibold"><i class="fa-solid fa-circle-xmark"></i> Trượt</span>
              {% else %}
                <span class="text-yellow-500 font-semibold"><i class="fa-solid fa-clock"></i> Đang xét</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded text-yellow-900 mt-4">Bạn chưa có nguyện vọng nào.</div>
    {% endif %}
  </div>
</div>
{% endblock %}